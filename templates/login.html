{% extends 'base.html' %}
{% load static %}

{% block title %}Login - QuickMeds{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login.css' %}">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
<style>
/* Override base template styles for login page */
body {
	padding: 0;
	margin: 0;
}
.main-content {
	padding: 0;
	margin: 0;
	width: 100%;
}
</style>
{% endblock %}

{% block header %}
<!-- No navbar on login page -->
{% endblock %}

{% block footer %}
<!-- No footer on login page -->
{% endblock %}

{% block content_wrapper %}
<div class="login-wrapper">
	<div class="container" id="container">
		<div class="form-container sign-up-container">
			<form id="signupForm" onsubmit="return handleSignup(event)">
				{% csrf_token %}
				<h1>Create Account</h1>
				<span>Sign up to get started</span>
				<div id="registration-step-1">
					<input type="text" name="name" placeholder="Full Name" required autocomplete="name" />
					<input type="email" name="email" placeholder="Email" required autocomplete="email" />
					<div class="password-wrapper">
						<input type="password" name="password" id="password" placeholder="Password" required minlength="8" autocomplete="new-password" />
						<button type="button" class="password-toggle" onclick="togglePassword('password')">
							<i class="fas fa-eye" id="password-eye"></i>
						</button>
					</div>
					<div class="password-wrapper">
						<input type="password" name="confirm_password" id="confirm_password" placeholder="Confirm Password" required autocomplete="new-password" />
						<button type="button" class="password-toggle" onclick="togglePassword('confirm_password')">
							<i class="fas fa-eye" id="confirm_password-eye"></i>
						</button>
					</div>
					<div id="password-match-message" class="password-message"></div>
					<button type="submit" class="sign-button">SIGN UP</button>
				</div>
				<div id="registration-step-2" style="display: none;">
					<p>Please enter the OTP sent to your email</p>
					<div class="otp-input-container">
						<input type="text" maxlength="1" class="otp-input" />
						<input type="text" maxlength="1" class="otp-input" />
						<input type="text" maxlength="1" class="otp-input" />
						<input type="text" maxlength="1" class="otp-input" />
					</div>
					<button type="button" class="sign-button" onclick="verifyOTP()">Verify OTP</button>
					<button type="button" class="sign-button resend" onclick="resendOTP()">Resend OTP</button>
				</div>
			</form>
		</div>
		<div class="form-container sign-in-container">
			<form id="loginForm" onsubmit="return handleLogin(event)">
				{% csrf_token %}
				<h1>Welcome Back</h1>
				<span>Sign in to your account</span>
				<div id="login-step-1">
					<input type="email" name="email" placeholder="Email" required autocomplete="email" />
					<div class="password-wrapper">
						<input type="password" name="password" id="login_password" placeholder="Password" required autocomplete="current-password" />
						<button type="button" class="password-toggle" onclick="togglePassword('login_password')">
							<i class="fas fa-eye" id="login_password-eye"></i>
						</button>
					</div>
					<a href="#" class="forgot-password">Forgot your password?</a>
					<button type="submit" class="sign-button">SIGN IN</button>
				</div>
				<div id="login-step-2" style="display: none;">
					<p>Please enter the OTP sent to your email</p>
					<div class="otp-input-container">
						<input type="text" maxlength="1" class="otp-input-login" />
						<input type="text" maxlength="1" class="otp-input-login" />
						<input type="text" maxlength="1" class="otp-input-login" />
						<input type="text" maxlength="1" class="otp-input-login" />
					</div>
					<button type="button" class="sign-button" onclick="verifyLoginOTP()">Verify OTP</button>
					<button type="button" class="sign-button resend" onclick="resendLoginOTP()">Resend OTP</button>
					<button type="button" class="sign-button back-to-login" onclick="backToLogin()">Back to Login</button>
				</div>
				<div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
					<a href="{% url 'admin_login' %}" class="admin-link" style="color: #666; font-size: 12px; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 5px;">
						<i class="fas fa-user-shield"></i>
						<span>Admin Panel</span>
					</a>
				</div>
			</form>
		</div>
		<div class="overlay-container">
			<div class="overlay">
				<div class="overlay-panel overlay-left">
					<h1>Welcome Back!</h1>
					<p>Sign in to access your account and continue your healthcare journey</p>
					<button class="ghost" id="signIn">SIGN IN</button>
				</div>
				<div class="overlay-panel overlay-right">
					<h1>Hello, Friend!</h1>
					<p>Create an account and discover a better way to manage your health</p>
					<button class="ghost" id="signUp">SIGN UP</button>
				</div>
			</div>
		</div>
	</div>

	{% if messages %}
	<div class="messages">
		{% for message in messages %}
		<div class="alert alert-{{ message.tags }}">
			{{ message }}
		</div>
		{% endfor %}
	</div>
	{% endif %}
</div>
{% endblock content_wrapper %}

{% block extra_js %}
<script src="{% static 'js/login.js' %}"></script>
{% endblock %}
